#!/bin/sh

modtest=`uname -r`
moddir=/lib/modules/$modtest
MODULES=`find /lib/modules -type f`;

start() {
 echo "Starting modules.dep generate..."
    depmod
    ln -sf $moddir/modules.dep /etc/modules.dep
    for i in $MODULES; do
	echo $i;
	insmod $i
    done

}

stop() {
 echo "Stop modules.dep generate..."
}

case "$1" in
	start)
	    start
	    ;;

	stop)
	    stop
	    ;;

	restart)
	    stop
	    start
	    ;;

	*)
	    echo $"Usage: $0 {start|stop|restart}"
	    exit 1
esac
